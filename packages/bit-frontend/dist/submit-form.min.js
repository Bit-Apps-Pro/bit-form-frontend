!function(){"use strict";function e(e,t){const o=new URL(e);return o.searchParams.append("action","bitforms_submit_form"),fetch(o,{method:"POST",body:t})}function t(e,t,n){e.then((e=>new Promise(((o,n)=>{if(e.staus>400){const o=new CustomEvent("bf-form-submit-error",{detail:{formId:t,errors:result.data}});bfSelect(`#form-${t}`).dispatchEvent(o),500===e.staus?n(new Error("Mayebe Internal Server Error")):n(e.json())}else o(e.json())})))).then((e=>{const a=new CustomEvent("bf-form-submit-success",{detail:{formId:t,entryId:e.entryId,formData:n}});bfSelect(`#form-${t}`).dispatchEvent(a);let r=null,s=null,d="";if(void 0!==e&&e.success){const o=bfSelect(`#form-${t}`);var c,i;bfReset(t),"object"==typeof e.data?(o&&(null==e||null===(c=e.data)||void 0===c||null===(i=c.hidden_fields)||void 0===i||i.map((e=>{setHiddenFld(e,o)}))),r=e.data.redirectPage,e.data.cron&&(s=e.data.cron),e.data.cronNotOk&&(s=e.data.cronNotOk),e.data.new_nonce&&(d=e.data.new_nonce),setBFMsg({contentId:t,msgId:e.data.msg_id,msg:e.data.message,show:!0,type:"success",error:!1})):setBFMsg({contentId:t,msg:e.data,type:"success",show:!0,error:!1})}else{const o=new CustomEvent("bf-form-submit-error",{detail:{formId:t,errors:e.data}});bfSelect(`#form-${t}`).dispatchEvent(o),bfValidationErrMsg(e,t)}if(function(e,t,o){const n=window.bf_globals[o];if(e)if("string"==typeof e){const t=new URL(e);t.protocol!==window.location.protocol&&(t.protocol=window.location.protocol),fetch(t)}else{const o=new URL(n.ajaxURL);o.searchParams.append("action","bitforms_trigger_workflow");const a={cronNotOk:e,token:t||n.nonce,id:n.appID};fetch(o,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((e=>e.json()))}}(s,d,t),r){const e=setTimeout((()=>{window.location=decodeURI(r),e&&clearTimeout(e)}),1e3)}o(t,!1)})).catch((e=>{const n=null!=e&&e.message?e.message:"Unknown Error";setBFMsg({contentId:t,msg:n,show:!0,type:"error",error:!0}),o(t,!1)}))}function o(e,t){bfSelect('button[type="submit"]',bfSelect(`#form-${e}`)).disabled=t}document.querySelectorAll("form").forEach((n=>{var a,r;null!==(a=n.id)&&void 0!==a&&a.startsWith("form-bitforms")&&(n.addEventListener("submit",(n=>function(n){n.preventDefault();const a=n.target.id.slice(n.target.id.indexOf("-")+1);if("undefined"!=typeof validateForm&&!validateForm({form:a})){const e=new CustomEvent("bf-form-validation-error",{detail:{formId:a,fieldId:"",error:""}});return void n.target.dispatchEvent(e)}o(a,!0);let r=new FormData(n.target);const s=window.bf_globals[a];"undefined"!=typeof advancedFileHandle&&(r=advancedFileHandle(s,r)),s.GCLID&&r.set("GCLID",s.GCLID);const d=[];Object.entries((null==s?void 0:s.fields)||{}).forEach((e=>{var t,o;null!==(t=e[1])&&void 0!==t&&null!==(o=t.valid)&&void 0!==o&&o.hide&&d.push(e[0])})),d.length&&r.append("hidden_fields",d),"v3"===(null==s?void 0:s.gRecaptchaVersion)&&null!=s&&s.gRecaptchaSiteKey?grecaptcha.ready((()=>{grecaptcha.execute(s.gRecaptchaSiteKey,{action:"submit"}).then((o=>{r.append("g-recaptcha-response",o),t(e(null==s?void 0:s.ajaxURL,r),a,r)}))})):t(e(null==s?void 0:s.ajaxURL,r),a,r)}(n))),null===(r=bfSelect('button[type="reset"]',n))||void 0===r||r.addEventListener("click",(e=>bfReset(n.id.replace("form-",""),!0))))})),document.querySelectorAll(".msg-backdrop,.msg-close").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),bfSelect(`#${e.dataset.contentid} .msg-container-${e.dataset.msgid}`).classList.replace("active","deactive")}))})),localStorage.setItem("bf-entry-id","")}();
