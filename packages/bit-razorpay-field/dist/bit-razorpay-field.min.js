!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bit_razorpay_field=t()}(this,(function(){"use strict";const e=".bf-form";return class{#e=null;#t={clientId:"",options:{currency:"INR",amount:1,amountType:"fixed",theme:{},modal:{},prefill:{},notes:{}}};#n=null;#i=null;constructor(e,t){Object.assign(this.#t,t),this.#n=t.document||document,this.#i=t.window||window,this.#e="string"==typeof e?this.#n.querySelector(e):e,this.init()}init(){this.#o(this.#a(`.${this.#t.fieldKey}-razorpay-btn`),"click",(()=>{this.#s()}))}#a(e,t){return t?this.#n.querySelector(t).querySelector(e):this.#e.querySelector(e)}#o(e,t,n){e.addEventListener(t,n)}#r(t){let n=this.#a(`[name="${t}"]`,e);return n?("radio"===n.type&&(n=this.#a(`[name="${t}"]:checked`,e)),n.value||""):""}#c=e=>{var t;const n=document.getElementById(`${this.#t.contentId}`);n.classList.add("pos-rel","form-loading");const i=document.getElementById(`form-${this.#t.contentId}`),o=null===(t=this.#t.contentId)||void 0===t?void 0:t.split("_")[1];if(null!=i){var a,s;const t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name",this.#t.fieldKey),t.setAttribute("id","razorpayfield"),t.setAttribute("value",e.razorpay_payment_id),i.appendChild(t);let r=i.querySelector('button[type="submit"]');r||(r=document.createElement("input"),r.setAttribute("type","submit"),r.style.display="none",i.appendChild(r)),r.click();const c={formID:o,fieldKey:this.#t.fieldKey,transactionID:e.razorpay_payment_id,payment_type:"subscription"===this.#t.payType?"subscription":"order"},d=new URL(null===(a=bf_globals[this.#t.contentId])||void 0===a?void 0:a.ajaxURL);d.searchParams.append("_ajax_nonce",null===(s=bf_globals[this.#t.contentId])||void 0===s?void 0:s.nonce),d.searchParams.append("action","bitforms_save_razorpay_details"),fetch(d,{method:"POST",body:JSON.stringify(c)}).then((e=>{n.classList.remove("pos-rel","form-loading")}))}};#s=()=>{const{currency:e,amount:t,amountType:n,amountFld:i,name:o,description:a,theme:s,prefill:r,modal:c,notes:d}=this.#t.options,{confirm_close:l}=c,p=100*Number("fixed"===n?t:this.#r(i)),u={key:this.#t.clientId,currency:e,amount:p,name:o,description:a,theme:s,prefill:{name:this.#r(r.name),email:this.#r(r.email),contact:this.#r(r.contact)},notes:d,modal:{backdropclose:!1,escape:!1,confirm_close:l},handler:async e=>this.#c(e)};isFormValidatedWithoutError(this.#t.contentId,handleFormValidationErrorMessages).then((()=>{new this.#i.Razorpay(u).open()})).catch((e=>(alert(`restult 1${e}`),!1)))};destroy(){this.#e.innerHTML=""}reset(){this.destroy(),this.init()}}}));
