!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bit_razorpay_field=t()}(this,(function(){"use strict";const e=".bf-form";return class{#e=null;#t={clientId:"",options:{currency:"INR",amount:1,amountType:"fixed",theme:{},modal:{},prefill:{},notes:{}}};#n=null;#i=null;constructor(e,t){Object.assign(this.#t,t),this.#n=t.document||document,this.#i=t.window||window,this.#e="string"==typeof e?this.#n.querySelector(e):e,this.init()}init(){this.#o(this.#a(`.${this.#t.fieldKey}-razorpay-btn`),"click",(()=>{this.#s()}))}#a(e,t){return t?this.#n.querySelector(t).querySelector(e):this.#e.querySelector(e)}#o(e,t,n){e.addEventListener(t,n)}#r(t){let n=this.#a(`[name="${t}"]`,e);return n?("radio"===n.type&&(n=this.#a(`[name="${t}"]:checked`,e)),n.value||""):""}#c=e=>{const t=document.getElementById(`${this.#t.contentId}`);t.classList.add("pos-rel","form-loading");const n=document.getElementById(`form-${this.#t.contentId}`),i=this.#t.contentId?.split("_")[1];if(null!=n){const o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",this.#t.fieldKey),o.setAttribute("id","razorpayfield"),o.setAttribute("value",e.razorpay_payment_id),n.appendChild(o);let a=n.querySelector('button[type="submit"]');a||(a=document.createElement("input"),a.setAttribute("type","submit"),a.style.display="none",n.appendChild(a)),a.click();const s={formID:i,fieldKey:this.#t.fieldKey,transactionID:e.razorpay_payment_id,payment_type:"subscription"===this.#t.payType?"subscription":"order"},r=new URL(bf_globals[this.#t.contentId]?.ajaxURL);r.searchParams.append("_ajax_nonce",bf_globals[this.#t.contentId]?.nonce),r.searchParams.append("action","bitforms_save_razorpay_details"),fetch(r,{method:"POST",body:JSON.stringify(s)}).then((()=>{t.classList.remove("pos-rel","form-loading")}))}};#s=()=>{const{currency:e,amount:t,amountType:n,amountFld:i,name:o,description:a,theme:s,prefill:r,modal:c,notes:d}=this.#t.options,{confirm_close:l}=c,p=100*Number("fixed"===n?t:this.#r(i)),m={key:this.#t.clientId,currency:e,amount:p,name:o,description:a,theme:s,prefill:{name:this.#r(r.name),email:this.#r(r.email),contact:this.#r(r.contact)},notes:d,modal:{backdropclose:!1,escape:!1,confirm_close:l},handler:async e=>this.#c(e)};isFormValidatedWithoutError(this.#t.contentId,handleFormValidationErrorMessages).then((()=>{new this.#i.Razorpay(m).open()})).catch((e=>!1))};destroy(){this.#e.innerHTML=""}reset(){this.destroy(),this.init()}}}));
