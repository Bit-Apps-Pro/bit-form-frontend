!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).bit_filepond_plugin_image_crop=t()}(this,(function(){"use strict";
/*!
   * FilePondPluginImageCrop 2.0.6
   * Licensed under MIT, https://opensource.org/licenses/MIT/
   * Please visit https://pqina.nl/filepond/ for details.
   */const e=e=>/^image/.test(e.type),t=t=>{let{addFilter:o,utils:n}=t;const{Type:i,isFile:r,getNumericAspectRatioFromString:a}=n,p=(t,o)=>!(!e(t.file)||!o("GET_ALLOW_IMAGE_CROP")),d=e=>"object"==typeof e,s=e=>"number"==typeof e,c=(e,t)=>e.setMetadata("crop",Object.assign({},e.getMetadata("crop"),t));return o("DID_CREATE_ITEM",((e,t)=>{let{query:o}=t;e.extend("setImageCrop",(t=>{if(p(e,o)&&d(center))return e.setMetadata("crop",t),t})),e.extend("setImageCropCenter",(t=>{if(p(e,o)&&d(t))return c(e,{center:t})})),e.extend("setImageCropZoom",(t=>{if(p(e,o)&&s(t))return c(e,{zoom:Math.max(1,t)})})),e.extend("setImageCropRotation",(t=>{if(p(e,o)&&s(t))return c(e,{rotation:t})})),e.extend("setImageCropFlip",(t=>{if(p(e,o)&&d(t))return c(e,{flip:t})})),e.extend("setImageCropAspectRatio",(t=>{if(!p(e,o)||void 0===t)return;const n=e.getMetadata("crop"),i=a(t),r={center:{x:.5,y:.5},flip:n?Object.assign({},n.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:i};return e.setMetadata("crop",r),r}))})),o("DID_LOAD_ITEM",((t,o)=>{let{query:n}=o;return new Promise(((o,i)=>{const p=t.file;if(!r(p)||!e(p)||!n("GET_ALLOW_IMAGE_CROP"))return o(t);if(t.getMetadata("crop"))return o(t);const d=n("GET_IMAGE_CROP_ASPECT_RATIO");t.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:d?a(d):null}),o(t)}))})),{options:{allowImageCrop:[!0,i.BOOLEAN],imageCropAspectRatio:[null,i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t}));
