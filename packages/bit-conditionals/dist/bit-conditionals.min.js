var bit_conditionals=function(){"use strict";const e=(e,t,r)=>{switch(e){case"and":return t&&r;case"or":return t||r;default:return!1}},t=(e,t,p,g)=>{switch(e.logic){case"equal":return r(e,t,p,g);case"not_equal":return i(e,t,p,g);case"null":return!p&&0===p.length;case"not_null":return p&&p.length>0;case"contain":return n(e,t,p,g);case"contain_all":return l(e,t,p,g);case"not_contain":return s(e,t,p,g);case"greater":return a(e,t,p,g);case"less":return c(e,t,p,g);case"greater_or_equal":return o(e,t,p,g);case"less_or_equal":return u(e,t,p,g);case"start_with":return f(e,t,p,g);case"end_with":return d(e,t,p,g);case"between":return h(e,t,p,g);case"on_click":return!0;default:return!1}},r=(e,t,r,i)=>{if(!t[e.field].value)return!1;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r),t=i.split(",");let n=0;return e.forEach((r=>{e.length>0&&-1!==t.indexOf(r)&&(n+=1)})),n===t.length&&t.length===e.length}return r===i},i=(e,t,r,i)=>{if(!r)return!1;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r),t=i.split(",");if(e.length!==t.length)return!0;let n=0;return t.forEach((t=>{e.length>0&&-1===e.indexOf(t)&&(n+=1)})),t.length===n}return r!==i},n=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1!==e.indexOf(t)&&(l+=1)})),l>0}return n.forEach((e=>{r.length>0&&-1!==r.indexOf(e)&&(l+=1)})),l>0},l=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1!==e.indexOf(t)&&(l+=1)})),l>=n.length}return!1},s=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1===e.indexOf(t)&&(l+=1)})),l===n.length}return n.forEach((e=>{r.length>0&&-1===r.indexOf(e)&&(l+=1)})),l===n.length},a=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)>Number(i):""!==r&&r>i),c=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)<Number(i):""!==r&&r<i),o=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)>=Number(i):""!==r&&r>=i),u=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)<=Number(i):""!==r&&r<=i),f=(e,t,r,i)=>!!r&&""!==r&&0===r.indexOf(i),d=(e,t,r,i)=>!!r&&i===r.substr(r.length-i.length,r.length),h=(e,t,r,i)=>{if(!r)return!1;let n=r,l=i.min,s=i.max;return"number"===t[e.field].type&&(n=Number(r),l=Number(i.min),s=Number(i.max)),n>=l&&n<=s},p=e=>e.match(/\([A-Za-z\s0-9+-\\*]*\)/g),g=(e,t,r)=>{switch(e){case"_bf_length":return t[0].length;case"_bf_count":return r.match(/check|radio|select/)?t[0].trim().split(",").length:t[0].split(/\b\W+\b/g).length;default:return t[0]}},m=(r,i,n)=>{if(Array.isArray(r)){let t=!1;for(let l=0;l<r.length;l+=1){const s=r[l];if("string"!=typeof s){const a=m(s,i,n);if(0===l&&(t=a),l-1>=0&&"string"==typeof r[l-1]){const i=r[l-1].toLowerCase();t=e(i,t,a)}}}return t}const l=b(r.val,i),s=Object.entries(n.smartTags).reduce(((e,t)=>{let[i,n]=t;return{...e,[`\${${i}${"string"==typeof n?"":"()"}}`]:{value:"string"==typeof n?n:(null==n?void 0:n[null==r?void 0:r.smartKey])||"",type:"text",multiple:!1}}}),{}),a={...i,...s};if(void 0!==a[r.field]){const e=a[r.field].value;return t(r,a,e,l)}if(p(r.field)){const e=r.field.substring(2,r.field.length-1).replace(/\([A-Za-z\s0-9+-\\*]*\)/g,""),i=g(e,[a[r.smartKey].value],a[r.smartKey].type);return isNaN(i)?a[r.field]={type:"text"}:a[r.field]={type:"number"},t(r,a,i,l)}return!1},y=(e,t)=>{const r=e.match(/\${\w[^${}]*}/g);let i=e;return r.map((e=>{let r=e;t[r]||(r=e.substring(2,e.length-1));let n="";if(t[r])n=t[r].value,Array.isArray(t[r].value)&&!Number.isNaN(t[r].value[0])&&(n=0,t[r].value.map((e=>{n+=Number(e)})));else if(p(r)){const e=r.replace(/\([A-Za-z\s0-9+-\\*]*\)/g,""),t=r.substring(r.indexOf("(")+1,r.length-1);n=g(e,[t],"")}i=i.replace(e,n)})),i},b=(e,t)=>{if(!e)return e;let r;if(r="object"==typeof e?JSON.stringify(e):JSON.parse(JSON.stringify(e)),"string"!=typeof r)return e;for(;r.match(/\${\w[^${}]*}/g);)r=y(r,t);return v(r)},v=e=>{if(!e)return e;let t=e;const r=e.match(/[\\+\-\\*\\/\\%]/g);if(r&&r.length>0){const r=e.match(/\w+/g);if(!r)return e;const i=r.filter((e=>Number.isNaN(e)));if(i&&i.length>0)return t;t=t.replace(/\{|\[/g,"("),t=t.replace(/\}|\]/g,")");try{t=Function(`"use strict"; return (${t})`)()}catch(t){return e}}return t},A=(e,t)=>document.querySelector(`#form-${e} ${t}`),N=(e,t,r)=>{t.inits&&t.inits[e]?t.inits[e].disabled=r:A(t.contentId,`.${e}-fld`).disabled=r},$=(e,t,r)=>{if(t.fields[e.field]){t.fields[e.field].valid.hide=r;const i=e.field,n=A(t.contentId,`.btcd-fld-itm.${i}`),l=window.getComputedStyle(n);let s=0;r?(setStyleProperty(n,"height",`${s}px`),n.classList.add("fld-hide")):(n.classList.remove("fld-hide"),s="border-box"===l.boxSizing?n.scrollHeight:parseInt(l.paddingTop)+parseInt(l.paddingBottom)+n.scrollHeight+parseInt(l.marginTop)+parseInt(l.marginBottom)+parseInt(l.borderTopWidth)+parseInt(l.borderBottomWidth),setStyleProperty(n,"height",`${s}px`))}},x=(e,t)=>Object.keys(t).find((r=>t[r].fieldName===e)),k=e=>"[]"===e.slice(-2)?e.slice(0,e.length-2):e;return function(e){var t,r;if(null==e||null===(t=e.target)||void 0===t||!t.form)return;const i=e.target,{form:n}=e.target,l=n.id.replace("form-",""),s=null===(r=window.bf_globals)||void 0===r?void 0:r[l];if(!s)return;const a=k(i.name),c=x(a,s.fields);if(!c)return;const o=((e,t)=>{const r=new FormData(e),{fields:i}=t,n={};return Array.from(r.entries()).forEach((e=>{let[t,r]=e;const l=x(k(t),i);l in i&&(n[l]?(Array.isArray(n[l])||(n[l]=[n[l]]),n[l].push(r)):n[l]=r)})),Object.keys(i).filter((e=>"button"===i[e].btnTyp)).forEach((e=>{n[e]=""})),Object.entries(n).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:{value:n,type:i[r].typ,multiple:Array.isArray(n)}}}),{})})(n,s),u=[],{onfieldCondition:f}=s;if(!f)return;const d=f.filter((e=>"on_input"===e.event_type)).filter((e=>e.conditions.some((e=>{var t;return null==e||null===(t=e.logics)||void 0===t?void 0:t.some((e=>e.field===c))}))));if(!d.length)return;d.forEach(((e,t)=>{const{conditions:r}=e,{length:i}=r;let n=!1,l=0;for(l=0;l<i;l+=1){const e=r[l];if(["if","else-if"].includes(e.cond_type)){const{logics:t}=e,r=t.filter((e=>"on_click"===e.logic));if(r.length&&c!==r[0].field)return!1;if(n=m(t,o,s),n)break}}u.push({workflowIndx:t,condIndx:l,logicStatus:n})}));const h={};u.reverse(),u.forEach((e=>{var t;let{workflowIndx:r,condIndx:i,logicStatus:n}=e;const{conditions:l}=d[r],a=l.find((e=>"else"===e.cond_type))||{},c=n?l[i].actions:a.actions;null==c||null===(t=c.fields)||void 0===t||t.forEach((e=>{if(h[e.field]||(h[e.field]=[]),!h[e.field].includes(e.action)){h[e.field].push(e.action);const t=Object.entries(s.smartTags).reduce(((e,t)=>{let[r,i]=t;return{...e,[`\${${r}}`]:{value:i,type:"text",multiple:!1}}}),{});((e,t,r,i)=>{if(void 0!==e.action&&void 0!==e.field)switch(r.fields[e.field].valid||(r.fields[e.field].valid={}),e.action){case"value":return((e,t,r)=>{if(void 0!==e.val&&t.fields[e.field]){const i=e.val?b(e.val,r):"";((e,t,r)=>{const{fieldName:i,typ:n}=t;if("radio"===n)return void(A(e,`input[name="${i}"][value="${r}"]`).checked=!0);if("check"===n){const t=r.split(",");return void((e,t)=>document.querySelectorAll(`#form-${e} ${t}`))(e,`input[name="${i}[]"]`).forEach((e=>{e.checked=t.includes(e.value)}))}if("decision-box"===n){const n=A(e,`input[name="${i}"]`);return void(n&&(n.checked=r===t.msg.checked))}const l=A(e,`[name^='${i}']`);l.value!==r&&(l.value=r,l.setAttribute("value",r))})(t.contentId,t.fields[e.field],i)}})(e,r,i);case"hide":return $(e,r,!0);case"disable":r.fields[e.field]&&N(e.field,r,!0);break;case"readonly":r.fields[e.field]&&((e,t,r)=>{t.inits&&t.inits[e]?t.inits[e].readonly=!0:A(t.contentId,`.${e}-fld`).readonly=!0})(e.field,r);break;case"enable":r.fields[e.field]&&N(e.field,r,!1);break;case"show":if(r.fields[e.field])return $(e,r,!1);break;case"activelist":r.fields[e.field]&&((e,t,r)=>{const i=e.field;if(t.inits&&t.inits[i]){const n=e.val?b(e.val,r):"";t.inits[i].activelist=n}})(e,r,i)}})(e,0,s,{...o,...t})}}))}))}}();
