var bit_conditionals=function(){"use strict";const e=(e,t,r)=>{switch(e){case"and":return t&&r;case"or":return t||r;default:return!1}},t=(e,t,m,p)=>{switch(e.logic){case"equal":return r(e,t,m,p);case"not_equal":return i(e,t,m,p);case"null":return!m&&0===m.length;case"not_null":return m&&m.length>0;case"contain":return n(e,t,m,p);case"contain_all":return l(e,t,m,p);case"not_contain":return s(e,t,m,p);case"greater":return a(e,t,m,p);case"less":return c(e,t,m,p);case"greater_or_equal":return o(e,t,m,p);case"less_or_equal":return u(e,t,m,p);case"start_with":return f(e,t,m,p);case"end_with":return d(e,t,m,p);case"between":return h(e,t,m,p);case"on_click":return!0;default:return!1}},r=(e,t,r,i)=>{if(!t[e.field].value)return!1;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r),t=i.split(",");let n=0;return e.forEach((r=>{e.length>0&&-1!==t.indexOf(r)&&(n+=1)})),n===t.length&&t.length===e.length}return r===i},i=(e,t,r,i)=>{if(!r)return!1;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r),t=i.split(",");if(e.length!==t.length)return!0;let n=0;return t.forEach((t=>{e.length>0&&-1===e.indexOf(t)&&(n+=1)})),t.length===n}return r!==i},n=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1!==e.indexOf(t)&&(l+=1)})),l>0}return n.forEach((e=>{r.length>0&&-1!==r.indexOf(e)&&(l+=1)})),l>0},l=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1!==e.indexOf(t)&&(l+=1)})),l>=n.length}return!1},s=(e,t,r,i)=>{if(!r)return!1;const n=i.split(",");let l=0;if(void 0!==t[e.field].multiple&&t[e.field].multiple||"check"===r||Array.isArray(r)){const e=Array.isArray(r)?r:JSON.parse(r);return n.forEach((t=>{e.length>0&&-1===e.indexOf(t)&&(l+=1)})),l===n.length}return n.forEach((e=>{r.length>0&&-1===r.indexOf(e)&&(l+=1)})),l===n.length},a=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)>Number(i):""!==r&&r>i),c=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)<Number(i):""!==r&&r<i),o=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)>=Number(i):""!==r&&r>=i),u=(e,t,r,i)=>!!r&&("number"===t[e.field].type?""!==r&&Number(r)<=Number(i):""!==r&&r<=i),f=(e,t,r,i)=>!!r&&""!==r&&0===r.indexOf(i),d=(e,t,r,i)=>!!r&&i===r.substr(r.length-i.length,r.length),h=(e,t,r,i)=>{if(!r)return!1;let n=r,l=i.min,s=i.max;return"number"===t[e.field].type&&(n=Number(r),l=Number(i.min),s=Number(i.max)),n>=l&&n<=s},m=e=>e.match(/\([A-Za-z\s0-9+-\\*]*\)/g),p=(e,t,r)=>{switch(e){case"_bf_length":return t[0].length;case"_bf_count":return r.match(/check|radio|select/)?t[0].trim().split(",").length:t[0].split(/\b\W+\b/g).length;default:return t[0]}},g=(r,i,n)=>{if(Array.isArray(r)){let t=!1;for(let l=0;l<r.length;l+=1){const s=r[l];if("string"!=typeof s){const a=g(s,i,n);if(0===l&&(t=a),l-1>=0&&"string"==typeof r[l-1]){const i=r[l-1].toLowerCase();t=e(i,t,a)}}}return t}const l=b(r.val,i),s=Object.entries(n.smartTags).reduce(((e,t)=>{let[i,n]=t;return{...e,[`\${${i}${"string"==typeof n?"":"()"}}`]:{value:"string"==typeof n?n:n?.[r?.smartKey]||"",type:"text",multiple:!1}}}),{}),a={...i,...s};if(void 0!==a[r.field]){const e=a[r.field].value;return t(r,a,e,l)}if(m(r.field)){const e=r.field.substring(2,r.field.length-1).replace(/\([A-Za-z\s0-9+-\\*]*\)/g,""),i=p(e,[a[r.smartKey].value],a[r.smartKey].type);return isNaN(i)?a[r.field]={type:"text"}:a[r.field]={type:"number"},t(r,a,i,l)}return!1},y=(e,t)=>{const r=e.match(/\${\w[^${}]*}/g);let i=e;return r.map((e=>{let r=e;t[r]||(r=e.substring(2,e.length-1));let n="";if(t[r])n=t[r].value,Array.isArray(t[r].value)&&!Number.isNaN(t[r].value[0])&&(n=0,t[r].value.map((e=>{n+=Number(e)})));else if(m(r)){const e=r.replace(/\([A-Za-z\s0-9+-\\*]*\)/g,""),t=r.substring(r.indexOf("(")+1,r.length-1);n=p(e,[t],"")}i=i.replace(e,n)})),i},b=(e,t)=>{if(!e)return e;let r;if(r="object"==typeof e?JSON.stringify(e):JSON.parse(JSON.stringify(e)),"string"!=typeof r)return e;for(;r.match(/\${\w[^${}]*}/g);)r=y(r,t);return v(r)},v=e=>{if(!e)return e;let t=e;const r=e.match(/[\\+\-\\*\\/\\%]/g);if(r&&r.length>0){const r=e.match(/\w+/g);if(!r)return e;const i=r.filter((e=>Number.isNaN(e)));if(i&&i.length>0)return t;t=t.replace(/\{|\[/g,"("),t=t.replace(/\}|\]/g,")");try{t=Function(`"use strict"; return (${t})`)()}catch(t){return e}}return t},A=(e,t,r)=>{t.inits&&t.inits[e]?t.inits[e].disabled=r:document.querySelector(`.${e}-fld`).disabled=r},N=(e,t,r)=>{if(t.fields[e.field]){t.fields[e.field].valid.hide=r;const i=e.field,n=document.querySelector(`.btcd-fld-itm.${i}`),l=window.getComputedStyle(n);let s=0;r?(setStyleProperty(n,"height",`${s}px`),n.classList.add("fld-hide")):(n.classList.remove("fld-hide"),s="border-box"===l.boxSizing?n.scrollHeight:parseInt(l.paddingTop)+parseInt(l.paddingBottom)+n.scrollHeight+parseInt(l.marginTop)+parseInt(l.marginBottom)+parseInt(l.borderTopWidth)+parseInt(l.borderBottomWidth),setStyleProperty(n,"height",`${s}px`))}},x=(e,t)=>Object.keys(t).find((r=>t[r].fieldName===e)),k=e=>"[]"===e.slice(-2)?e.slice(0,e.length-2):e;return function(e){if(!e?.target?.form)return;const t=e.target,{form:r}=e.target,i=r.id.replace("form-",""),n=window.bf_globals?.[i];if(!n)return;const l=k(t.name),s=x(l,n.fields);if(!s)return;const a=((e,t)=>{const r=new FormData(e),{fields:i}=t,n={};return Array.from(r.entries()).forEach((e=>{let[t,r]=e;const l=x(k(t),i);l in i&&(n[l]?(Array.isArray(n[l])||(n[l]=[n[l]]),n[l].push(r)):n[l]=r)})),Object.keys(i).filter((e=>"button"===i[e].btnTyp)).forEach((e=>{n[e]=""})),Object.entries(n).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:{value:n,type:i[r].typ,multiple:Array.isArray(n)}}}),{})})(r,n),c=[],{onfieldCondition:o}=n;if(!o)return;const u=o.filter((e=>"on_input"===e.event_type)).filter((e=>e.conditions.some((e=>e?.logics?.some((e=>e.field===s))))));if(!u.length)return;u.forEach(((e,t)=>{const{conditions:r}=e,{length:i}=r;let l=!1,o=0;for(o=0;o<i;o+=1){const e=r[o];if(["if","else-if"].includes(e.cond_type)){const{logics:t}=e,r=t.filter((e=>"on_click"===e.logic));if(r.length&&s!==r[0].field)return!1;if(l=g(t,a,n),l)break}}c.push({workflowIndx:t,condIndx:o,logicStatus:l})}));const f={};c.reverse(),c.forEach((e=>{let{workflowIndx:t,condIndx:r,logicStatus:i}=e;const{conditions:l}=u[t],s=l.find((e=>"else"===e.cond_type))||{};(i?l[r].actions:s.actions)?.fields?.forEach((e=>{if(f[e.field]||(f[e.field]=[]),!f[e.field].includes(e.action)){f[e.field].push(e.action);const t=Object.entries(n.smartTags).reduce(((e,t)=>{let[r,i]=t;return{...e,[`\${${r}}`]:{value:i,type:"text",multiple:!1}}}),{});((e,t,r,i)=>{if(void 0!==e.action&&void 0!==e.field)switch(r.fields[e.field].valid||(r.fields[e.field].valid={}),e.action){case"value":return((e,t,r)=>{if(void 0!==e.val&&t.fields[e.field]){const i=e.val?b(e.val,r):"";((e,t)=>{const{fieldName:r,typ:i}=e;if("radio"===i)return void(document.querySelector(`input[name="${r}"][value="${t}"]`).checked=!0);if("check"===i){const e=t.split(",");return void document.querySelectorAll(`input[name="${r}[]"]`).forEach((t=>{t.checked=e.includes(t.value)}))}if("decision-box"===i){const i=document.querySelector(`input[name="${r}"]`);return void(i&&(i.checked=t===e.msg.checked))}const n=document.querySelector(`[name^='${r}']`);n.value!==t&&(n.value=t,n.setAttribute("value",t))})(t.fields[e.field],i)}})(e,r,i);case"hide":return N(e,r,!0);case"disable":r.fields[e.field]&&A(e.field,r,!0);break;case"readonly":r.fields[e.field]&&((e,t,r)=>{t.inits&&t.inits[e]?t.inits[e].readonly=!0:document.querySelector(`.${e}-fld`).readonly=!0})(e.field,r);break;case"enable":r.fields[e.field]&&A(e.field,r,!1);break;case"show":if(r.fields[e.field])return N(e,r,!1);break;case"activelist":r.fields[e.field]&&((e,t,r)=>{const i=e.field;if(t.inits&&t.inits[i]){const n=e.val?b(e.val,r):"";t.inits[i].activelist=n}})(e,r,i)}})(e,0,n,{...a,...t})}}))}))}}();
