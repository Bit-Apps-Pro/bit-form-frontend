var bit_dropdown_field=function(){"use strict";return class{#t=null;#e=null;#s=null;#i=null;#l=null;#n=null;#o=null;#h=null;#a=null;#p=null;#r=null;#d=!1;#c=null;#u=null;#m="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>";#g="";#f=[];#O=[];#b=null;#C={};#E={separator:",",selectedOptImage:!1,dropdownIcn:"",selectedOptClearable:!0,searchClearable:!0,optionIcon:!0,defaultValue:"",placeholder:"Select an option",searchPlaceholder:"Search option",maxHeight:370,closeOnSelect:!1,showChip:!0,options:[],attributes:{},classNames:{},onChange:()=>{}};#v=null;#w="";#y=[];constructor(t,e){Object.assign(this.#E,e),this.#b=e.document?e.document:document,this.#C=e.window?e.window:window,this.#t="string"==typeof t?this.#b.querySelector(t):t,this.fieldKey=this.#E.fieldKey,this.init()}init(){this.#s=this.#I(`.${this.fieldKey}-dpd-hidden-input`),this.#i=this.#I(`.${this.fieldKey}-opt-search-input`),this.#l=this.#I(`.${this.fieldKey}-option-wrp`),this.#n=this.#I(`.${this.fieldKey}-dpd-wrp`),this.#o=this.#I(`.${this.fieldKey}-selected-opt-wrp`),this.#h=this.#I(`.${this.fieldKey}-selected-opt-img`),this.#a=this.#I(`.${this.fieldKey}-selected-opt-lbl`),this.#p=this.#I(`.${this.fieldKey}-selected-opt-clear-btn`),this.#r=this.#E.searchClearable?this.#I(`.${this.fieldKey}-search-clear-btn`):{},this.#x(this.#n,"click",(t=>{this.#S(t)})),this.#x(this.#n,"keyup",(t=>{this.#S(t)})),this.#x(this.#t,"keydown",(t=>{this.#A(t)})),this.#L(),this.#E.defaultValue&&this.setSelectedOption(this.#E.defaultValue),this.#k(),this.#E.selectedOptImage&&(this.#h.src=this.#m),this.#E.searchClearable&&(this.#i.style.paddingRight="25px",this.#r.style.display="none",this.#x(this.#r,"click",(()=>{this.searchOptions("")}))),this.#i.placeholder=this.#E.searchPlaceholder,this.#i.value="",this.#x(this.#i,"keyup",(t=>{this.#N(t)})),this.#d=this.#E.allowCustomOption,this.#C.observeElm(this.#s,"value",((t,e)=>{this.#T(t,e)}))}#L(){this.#u=this.#I(`.${this.fieldKey}-option-list.active-list`),this.#W(),this.#E.options=this.#V(),this.#O=[...this.#E.options]}#I(t,e){return e?e.querySelector(t):this.#t.querySelector(t)}#B(t){return this.#t.querySelectorAll(t)}#x(t,e,s){null==t||t.addEventListener(e,s),this.#y.push({selector:t,eventType:e,cb:s})}#F(t,e){t.appendChild(e)}#k(){this.#s.value&&(this.setSelectedOption(this.#s.value),this.#H())}#T(t,e){t!==e&&this.setSelectedOption(e),"undefined"!=typeof bit_conditionals&&bit_conditionals({target:this.#s})}#$(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=arguments.length>1?arguments[1]:void 0;if("next"===e){const e=this.#O.length;for(let s=t+1;s<e;s+=1){const t=this.#O[s];if("group"!==t.type&&!t.disabled)return s}}else if("previous"===e)for(let e=t-1;e>=0;e-=1){const t=this.#O[e];if("group"!==t.type&&!t.disabled)return e}}#D(t){return this.#I(`${this.#K()} .option[data-index="${t}"]`)}#A(t){const e=this.#b.activeElement;let s=null;if(this.#M()){const l=Number(e.dataset.index||-1);if("ArrowDown"===t.key||!t.shiftKey&&"Tab"===t.key){t.preventDefault();let i=0,n=null;e===this.#i?(i=this.#$(-1,"next"),this.#d&&0===i&&"block"!==this.#P(this.#c)&&(i=1),n=this.#D(i)):e.classList.contains("option")&&(i=this.#$(l,"next"),n=this.#D(i)),n&&(s=n)}else if("ArrowUp"===t.key||t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#i)s=this.#n,this.#M()&&this.setMenu({open:!1});else if(e.classList.contains("option")){var i;let t=this.#$(l,"previous");this.#j&&0===t&&"block"!==(null===(i=this.#c)||void 0===i?void 0:i.style.display)&&(t=-1);const e=this.#D(t);e?s=e:e||(s=this.#i)}}else"Escape"===t.key&&this.setMenu({open:!1})}else if(t.key>="a"&&t.key<="z"){clearTimeout(this.#v),this.#w+=t.key,this.#v=setTimeout((()=>{this.#w=""}),300);const e=this.#E.options.find((t=>"group"!==t.type&&!t.disabled&&t.lbl.toLowerCase().startsWith(this.#w)));e&&this.setSelectedOption(e.val)}else if("ArrowDown"===t.key||"ArrowUp"===t.key){if(this.#E.multipleSelect)return;t.preventDefault();const e=this.#R(),s="ArrowDown"===t.key?"next":"previous";let i=this.#$(e,s);this.#d&&0===i&&(i=1),i>-1&&i<this.#E.options.length&&(this.value=this.#E.options[i].val)}else if(("ArrowRight"===t.key||"ArrowLeft"===t.key)&&e.classList.contains("chip-clear-btn")){let i=null;"ArrowRight"===t.key?i=e.parentElement.nextElementSibling:"ArrowLeft"===t.key&&(i=e.parentElement.previousElementSibling),i&&(s=this.#I(".chip-clear-btn",i))}s&&s.focus()}#K(){var t;const e=null===(t=this.#u)||void 0===t?void 0:t.dataset.list;return e?`.${this.fieldKey}-option-list[data-list="${e}"]`:`.${this.fieldKey}-option-list`}#V(){const t=Array.from(this.#B(`${this.#K()} .option`)),e=t=>{const e={},s=t.querySelector(".opt-lbl"),{value:i}=t.dataset;e.lbl=s.textContent,i&&(e.val=i),this.#q(t,"disabled-opt")&&(e.disabled=!0);const l=t.querySelector(".opt-icn");this.#E.selectedOptImage&&null!=l&&l.src&&(e.icn=l.src);const{attributes:n}=t,o=n.length;e.attributes={};for(let s=0;s<o;s+=1){const i=n[s].nodeName;e.attributes[i]=t.getAttribute(i)}return e},s=[],{length:i}=t;for(let l=0;l<i;l+=1){const n=t[l];let o={},h=null;if(n.classList.contains("opt-group-title")){o=e(n),o.type="group",s.push(o),h=l;for(let n=l+1;n<i;n+=1){const i=t[n];if(!i.classList.contains("opt-group-child")){l=n-1;break}{const t=e(i);t.groupIndex=h,l=n,s.push(t)}}}else o=e(n),s.push(o)}return s}#_(t){null==t||t.stopPropagation(),this.#g="",this.#E.selectedOptImage&&(this.#h.src=this.#m,this.#z(this.#h)),this.#E.multipleSelect&&this.#E.showChip&&this.#U([]),this.#E.showChip||this.#G(this.#a,this.#E.placeholder),this.#E.selectedOptClearable&&(this.#p.style.display="none"),this.#H()}#J(t){return[...this.#E.options,...this.#f].find((e=>e.val===t))}#U(t){if(this.#G(this.#a,""),this.#e=this.#t.parentElement,!t.length)return this.#e.style.removeProperty("min-height"),this.#E.selectedOptImage&&(this.#h.style.display="block"),void this.#G(this.#a,this.#E.placeholder);this.#E.selectedOptImage&&(this.#h.style.display="none"),t.forEach(((t,e)=>{var s,i,l,n,o,h;const a=this.#Q("div");this.#X(a,"chip-wrp");const p=null===(s=this.#E.customClasses)||void 0===s?void 0:s["chip-wrp"];p&&this.#Y(a,p);const r=null===(i=this.#E.customAttributes)||void 0===i?void 0:i["chip-wrp"];if(r&&this.#Z(a,r),this.#E.selectedOptImage&&this.#E.optionIcon){var d,c;const e=this.#Q("img");this.#X(e,"chip-icn");const s=this.#J(t);this.#tt(e,"src",s.icn||this.#m),this.#z(e,s.icn),this.#tt(e,"alt",s.lbl);const i=null===(d=this.#E.customClasses)||void 0===d?void 0:d["chip-icn"];i&&this.#Y(e,i);const l=null===(c=this.#E.customAttributes)||void 0===c?void 0:c["chip-icn"];l&&this.#Z(e,l),this.#F(a,e)}const u=this.#Q("span");this.#X(u,"chip-lbl");const m=null===(l=this.#E.customClasses)||void 0===l?void 0:l["chip-lbl"];m&&this.#Y(u,m);const g=null===(n=this.#E.customAttributes)||void 0===n?void 0:n["chip-lbl"];g&&this.#Z(u,g),this.#G(u,t),this.#F(a,u);const f=this.#Q("button");this.#X(f,"chip-clear-btn");const O=null===(o=this.#E.customClasses)||void 0===o?void 0:o["chip-clear-btn"];O&&this.#Y(f,O);const b=null===(h=this.#E.customAttributes)||void 0===h?void 0:h["chip-clear-btn"];b&&this.#Z(f,b),f.innerHTML=this.#p.innerHTML,this.#x(f,"click",(t=>{this.#et(t,e)})),this.#x(f,"keyup",(t=>{"Backspace"===t.key&&this.#et(t,e)})),this.#F(a,f),this.#F(this.#a,a)})),this.#e=this.#t.parentElement,this.#e.style.minHeight=this.#t.offsetHeight-this.#l.offsetHeight+"px"}#et(t,e){t.stopPropagation();const s=this.#g.split(this.#E.separator);s.splice(e,1),this.setSelectedOption(s.join(this.#E.separator)),this.#H()}#z(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.#st(t,"placeholder-img"):this.#X(t,"placeholder-img")}setSelectedOption(t){let e=null,s=t.split(this.#E.separator);s=s.filter((t=>this.#J(t))),this.#E.multipleSelect?1===s.length?e=this.#J(s[0]):s.length>1&&(e={lbl:`${s.length} options selected`}):e=this.#J(t),this.#g=t,this.#g||this.#_(),e&&(this.#E.selectedOptImage&&(this.#E.multipleSelect?s.length>1?(this.#h.src=this.#m,this.#z(this.#h)):1===s.length?(this.#h.src=e.icn||this.#m,this.#z(this.#h,e.icn)):(this.#h.src=this.#m,this.#z(this.#h)):(this.#h.src=e.icn||this.#m,this.#z(this.#h,e.icn))),this.#E.multipleSelect&&this.#E.showChip&&this.#U(s),this.#E.showChip||this.#G(this.#a,e.lbl),this.#E.closeOnSelect&&this.setMenu({open:!1}),this.#tt(this.#s,"value",t),this.#E.selectedOptClearable&&(this.#p.style.display="grid",this.#x(this.#p,"click",(t=>{this.#_(t)}))),this.#E.onChange&&this.#E.onChange(t))}#R(){return this.#O.findIndex((t=>t.val===this.#g))}#Q(t){return this.#b.createElement(t)}#it(t,e){t.tabIndex=e}#X(t,e){t.classList.add(e)}#st(t,e){t.classList.remove(e)}#P(t){return(null==t?void 0:t.style.display)||""}#q(t,e){return t.classList.contains(e)}#G(t,e){t.textContent=e}#lt(t){return t&&t.split(this.#E.separator)||[]}#nt(t){return t.join(this.#E.separator)}#ot(t){t.stopPropagation();const e=t.currentTarget,s=e.dataset.value;if(this.#d&&e.classList.contains("create-opt")&&this.#j(s),this.#E.multipleSelect){const t=this.#lt(this.#g);if(t.includes(s)){const i=t.indexOf(s);t.splice(i,1),this.#st(e,"selected-opt")}else t.push(s),this.#X(e,"selected-opt");this.#g=this.#nt(t)}else this.#g=s;this.setSelectedOption(this.#g),setTimeout((()=>{this.#I(`${this.#K()} .option[data-value="${s}"]`).focus()}),0)}#H(){this.#ht()}#at(){return this.#B(`${this.#K()} .option:not(.opt-group-title):not(.create-opt)`)}#W(){const t=this.#at(),e=t.length;for(let s=0;s<e;s+=1){const e=t[s];this.#x(e,"click",(t=>{this.#ot(t)})),this.#x(e,"keyup",(t=>{"Enter"===t.key&&this.#ot(t)}))}}#pt(){const t=this.#at(),e=this.#M(),s=t.length;for(let i=0;i<s;i+=1){const s=t[i];e?this.#it(s,0):this.#it(s,-1)}}#tt(t,e,s){var i;null==t||null===(i=t.setAttribute)||void 0===i||i.call(t,e,s)}#Y(t,e){e.trim().split(/\b\s+\b/g).forEach((e=>this.#X(t,e)))}#Z(t,e){const s=e.length;if(s)for(let i=0;i<s;i+=1)this.#tt(t,e[i].key,e[i].value)}#ht(){this.#u.innerHTML="";const t=this.#g.split(this.#E.separator),e=this.#O.length;for(let s=0;s<e;s+=1){const e=this.#O[s],i=this.#Q("li");if("not-found"===e.i)return this.#G(i,e.lbl),this.#X(i,"opt-not-found"),void this.#F(this.#u,i);this.#X(i,"option");const l=this.#Q("span");if(this.#X(l,"opt-lbl-wrp"),"opt-lbl-wrp"in this.#E.classNames){const t=this.#E.classNames["opt-lbl-wrp"];t&&this.#Y(l,t)}if("opt-lbl-wrp"in this.#E.attributes){const t=this.#E.attributes["opt-lbl-wrp"];this.#Z(l,t)}if(this.#E.optionIcon){const t=this.#Q("img");if(this.#X(t,"opt-icn"),"opt-icn"in this.#E.classNames){const e=this.#E.classNames["opt-icn"];e&&this.#Y(t,e)}if("opt-icn"in this.#E.attributes){const e=this.#E.attributes["opt-icn"];this.#Z(t,e)}t.src=e.icn||this.#m,this.#z(t,e.icn),t.alt=e.lbl,t.loading="lazy",l.append(t)}const n=this.#Q("span");if(this.#X(n,"opt-lbl"),"opt-lbl"in this.#E.classNames){const t=this.#E.classNames["opt-lbl"];t&&this.#Y(n,t)}if("opt-lbl"in this.#E.attributes){const t=this.#E.attributes["opt-lbl"];this.#Z(n,t)}this.#G(n,e.lbl),l.append(n);const o=this.#Q("span");if(this.#X(o,"opt-prefix"),"opt-prefix"in this.#E.classNames){const t=this.#E.classNames["opt-prefix"];t&&this.#Y(o,t)}if("opt-prefix"in this.#E.attributes){const t=this.#E.attributes["opt-prefix"];this.#Z(n,t)}this.#G(o,e.code),i.append(l,o),Object.keys(e.attributes).map((t=>{this.#tt(i,t,e.attributes[t])})),t.includes(e.val)?(this.#X(i,"selected-opt"),this.#tt(i,"aria-selected",!0)):this.#tt(i,"aria-selected",!1),"group"===e.type?this.#X(i,"opt-group-title"):("groupIndex"in e&&this.#X(i,"opt-group-child"),this.#tt(i,"data-index",s),this.#tt(i,"data-value",e.val),this.#tt(i,"role","option"),this.#tt(i,"aria-posinset",s+1),this.#tt(i,"aria-setsize",this.#O.length),this.#it(i,this.#M()?"0":"-1"),e.disabled?this.#X(i,"disabled-opt"):(this.#x(i,"click",(t=>{this.#ot(t)})),this.#x(i,"keyup",(t=>{"Enter"===t.key&&this.#ot(t)})))),this.#F(this.#u,i)}}#N(t){if(t.stopPropagation(),"Enter"===t.key&&this.#O.length){var e;const s=null===(e=this.#O)||void 0===e?void 0:e[0].i;if(s&&(this.setSelectedOption(s),this.searchOptions("")),this.#d&&"none"!==this.#P(this.#c)){const{value:e}=t.target;if(this.#j(e),this.#E.multipleSelect){const t=this.#lt(this.#g);t.push(e),this.#g=this.#nt(t)}else this.#g=e;this.#H(),this.setSelectedOption(this.#g)}}else this.searchOptions(t.target.value)}#j(t){let e=t.trim();if(e.includes&&e){const t=this.#f.length;for(let s=0;s<t;s+=1)if(this.#f[s].lbl.toLowerCase()===e){e="";break}if(e){const t={lbl:e,val:e,attributes:{}};this.#f.push(t),this.#O.push(t),this.searchOptions("")}}}searchOptions(t){this.#rt(t);let e=[],s=!1;if(t){const i=this.#E.options.length,l=[],n=t.toLowerCase();for(let t=0;t<i;t+=1){const i=this.#E.options[t];if("type"in i)continue;const o=i.lbl.toLowerCase();if(o.includes(n)){if("groupIndex"in i&&!l.includes(i.groupIndex)){const t=i.groupIndex;l.push(t),e.push(this.#E.options[t])}e.push(i),o===n&&(s=!0)}}const o=this.#f.length;for(let t=0;t<o;t+=1){const i=this.#f[t],l=i.lbl.toLowerCase();l.includes(n)&&(e.push(i),l===n&&(s=!0))}e.length||(e=[{i:"not-found",lbl:"No Option Found"}]),this.#O=this.#d?[this.#E.options[0]]:[],this.#O.push(...e),this.#E.searchClearable&&(this.#r.style.display="grid")}else this.#O=this.#E.options,this.#E.searchClearable&&(this.#r.style.display="none"),this.#d&&(this.#c=this.#I(`${this.#K()} .create-opt`),this.#c.style.display="none",this.#O=this.#O.concat(this.#f));this.#H(),this.#c=this.#I(`${this.#K()} .create-opt`),s&&this.#d?this.#c.style.display="none":this.#d&&t.trim()&&(this.#c.style.display="block",this.#c.querySelector(".opt-lbl").innerText=`Create: ${t}`,this.#tt(this.#c,"data-value",t))}#rt(t){this.#i.value=t}#dt(t){this.#t.contains(t.target)||this.setMenu({open:!1})}#M(){return this.#q(this.#t,"menu-open")}#ct(){const t=this.#n.getBoundingClientRect(),e=t.top,s=this.#C.innerHeight-t.bottom;s<e&&s<this.#E.maxHeight?(this.#t.style.flexDirection="column-reverse",this.#t.style.bottom="0%"):(this.#t.style.flexDirection="column",this.#t.style.removeProperty("bottom"))}setMenu(t){let{open:e}=t;this.#l.style.maxHeight=`${e?this.#E.maxHeight:0}px`,e?(this.#ct(),this.#X(this.#t,"menu-open"),this.#x(this.#b,"click",(t=>this.#dt(t))),this.#it(this.#i,0),this.#it(this.#r,0),this.#n.setAttribute("aria-expanded","true"),this.#tt(this.#u,"aria-hidden",!1),this.#tt(this.#i,"aria-hidden",!1),this.#H()):(this.#st(this.#t,"menu-open"),this.#b.removeEventListener("click",this.#dt),setTimeout((()=>{this.searchOptions("")}),100),this.#it(this.#i,-1),this.#it(this.#r,-1),this.#n.setAttribute("aria-expanded","false"),this.#tt(this.#u,"aria-hidden",!0),this.#tt(this.#i,"aria-hidden",!0)),this.#pt()}#S(t){"Space"===t.code&&(this.#i.focus(),this.setMenu({open:!0})),"click"===t.type&&(this.#M()?this.setMenu({open:!1}):(this.#i.focus(),this.setMenu({open:!0})))}set activelist(t){const e=this.#I(`.${this.fieldKey}-option-list[data-list=${t}]`);e&&(this.#B(`.${this.fieldKey}-option-list:not([data-list=${t}])`).forEach((t=>this.#st(t,"active-list"))),this.#X(e,"active-list"),this.setSelectedOption(""),this.#L())}set disabled(t){"true"===String(t).toLowerCase()?(this.#t.classList.add("disabled"),this.#s.disabled=!0,this.#it(this.#n,-1),this.#it(this.#p,-1),this.#tt(this.#n,"aria-label","Dropdown disabled"),this.setMenu({open:!1})):"false"===String(t).toLowerCase()&&(this.#st(this.#t,"disabled"),this.#s.removeAttribute("disabled"),this.#it(this.#n,0),this.#it(this.#p,0),this.#tt(this.#n,"aria-label",this.#E.placeholder))}get disabled(){return this.#s.disabled}set readonly(t){"true"===String(t).toLowerCase()?(this.#X(this.#t,"disabled"),this.#s.readOnly=!0,this.#it(this.#n,-1),this.#it(this.#p,-1),this.setMenu({open:!1})):"false"===String(t).toLowerCase()&&(this.#st(this.#t,"disabled"),this.#s.removeAttribute("readonly"),this.#it(this.#n,0),this.#it(this.#p,0))}get readonly(){return this.#s.readOnly}set value(t){this.#s.value=t}get value(){return this.#s.value}#ut(){this.#y.forEach((t=>{let{selector:e,eventType:s,cb:i}=t;e.removeEventListener(s,i)}))}destroy(){this.value="",this.#ut()}reset(){this.#_(),this.destroy(),this.init()}}}();
