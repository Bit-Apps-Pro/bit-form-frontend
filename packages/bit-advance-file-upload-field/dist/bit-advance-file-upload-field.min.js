!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).bit_advance_file_upload_field=i()}(this,(function(){"use strict";return class{#e=null;#i=null;#n=null;#o={};#t=null;#a=null;#l=null;#s=null;#r={document:{},formID:null,configSetting:{},ajaxURL:null,nonce:null,uploadFileToServer:null};constructor(e,i){Object.assign(this.#r,i),this.#e="string"==typeof e?this.#r.document.querySelector(e):e,this.#n=this.#r.document,this.#t=this.#r.formID,this.#o=this.#r.configSetting,this.#a=this.#r.ajaxURL,this.#l=this.#r.nonce,this.#s=this.#r.uploadFileToServer,this.init()}init(){const e=[];if(this.#r.allowFileSizeValidation&&e.push(FilePondPluginFileValidateSize),this.#r.allowFileTypeValidation&&e.push(FilePondPluginFileValidateType),this.#r.allowImageCrop&&e.push(FilePondPluginImageCrop),this.#r.allowImagePreview&&e.push(FilePondPluginImagePreview),this.#r.allowImageResize&&e.push(FilePondPluginImageResize),this.#r.allowImageTransform&&e.push(FilePondPluginImageTransform),this.#r.allowImageValidateSize&&e.push(FilePondPluginImageValidateSize),this.#r.allowPreview&&e.push(FilePondPluginMediaPreview),registerPlugin(...e),this.#i=create(this.#o),this.#e.appendChild(this.#i.element),this.#s){const e=new URL(this.#a);e.searchParams.append("action","bitforms_file_store"),e.searchParams.append("_ajax_nonce",this.#l);const i=new URL(this.#a);i.searchParams.append("action","bitforms_file_remove"),i.searchParams.append("_ajax_nonce",this.#l),i.searchParams.append("form_id",this.#t),setOptions({server:{process:(i,n,o,t,a,l,s)=>{const r=new FormData;r.append(`${i}`,n,n.name),r.append("form_id",this.#t);const f=new XMLHttpRequest;return f.open("POST",e.href),f.upload.onprogress=e=>{l(e.lengthComputable,e.loaded,e.total)},f.onload=()=>{if(f.status>=200&&f.status<300){const e=JSON.parse(f.responseText);t(e.data)}else a("oh no")},f.send(r),{abort:()=>{f.abort(),s()}}},revert:i.href}})}}}}));
