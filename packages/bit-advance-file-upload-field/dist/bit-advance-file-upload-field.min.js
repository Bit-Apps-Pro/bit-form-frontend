var bit_advance_file_upload_field=function(){"use strict";return class{#e=null;#i=null;#t=null;#n=null;#o={};#l=null;#s=null;#a=null;#d=null;#f=null;#r={document:{},formID:null,configSetting:{},ajaxURL:null,nonce:null,uploadFileToServer:null};constructor(e,i){Object.assign(this.#r,i),this.#l=i.fieldKey,this.#e="string"==typeof e?this.#r.document.querySelector(e):e,this.#n=i.window?i.window:window,this.#t=i.document?i.document:document,this.#s=this.#r.formID,this.#o=this.#r.configSetting,this.#a=this.#r.ajaxURL,this.#d=this.#r.nonce,this.#f=this.#r.uploadFileToServer,this.uploaded_files=[],this.on_select_upload=!1,this.init()}init(){this.files=[];const e=[];this.#o.allowFileSizeValidation&&e.push(this.#n.bit_filepond_plugin_file_validate_size),this.#o.allowFileTypeValidation&&e.push(this.#n.bit_filepond_plugin_file_validate_type),this.#o.allowImageCrop&&e.push(this.#n.bit_filepond_plugin_image_crop),this.#o.allowImagePreview&&e.push(this.#n.bit_filepond_plugin_image_preview),this.#o.allowImageResize&&e.push(this.#n.bit_filepond_plugin_image_resize),this.#o.allowImageTransform&&e.push(this.#n.bit_filepond_plugin_image_transform),this.#o.allowImageValidateSize&&e.push(this.#n.bit_filepond_plugin_image_validate_size),this.#o.allowPreview&&e.push(this.#n.bit_filepond_plugin_media_preview);const{create:i,registerPlugin:t}=this.#n.bit_filepond;if(t(...e),this.#i=i(this.#o),this.#e.appendChild(this.#i.element),setTimeout((()=>{this.#t.querySelector(`.${this.#l}-lbl`).setAttribute("for",this.#p('input[name="filepond"]').id)}),100),this.#r.onFileUpdate&&this.#i.on("updatefiles",this.#r.onFileUpdate),this.#f){const e=new URL(this.#a);this.on_select_upload=this.#o.instantUpload,e.searchParams.append("_ajax_nonce",this.#d);let i=null;this.#i.setOptions({server:{process:(t,n,o,l,s,a,d)=>{const f=new FormData;e.searchParams.has("action")&&e.searchParams.delete("action"),e.searchParams.append("action","bitforms_file_upload"),f.append(this.#l,n,n.name),f.append("fieldKey",this.#l),f.append("formID",this.#s);const r=new XMLHttpRequest;return r.open("POST",e.href),r.upload.onprogress=e=>{a(e.lengthComputable,e.loaded,e.total)},r.onload=()=>{i=JSON.parse(r.responseText),r.status>=200&&r.status<300?(this.uploaded_files.push(i?.data?.file_name),l(i?.data?.file_name)):s()},r.send(f),{abort:()=>{r.abort(),d()}}},revert:(i,t,n)=>{if(this.uploaded_files.find((e=>e===i))){const o=this.uploaded_files.indexOf(i);this.uploaded_files.splice(o,1),e.searchParams.has("action")&&e.searchParams.delete("action"),e.searchParams.append("action","bitforms_file_delete"),e.searchParams.append("file_name",i);const l=new XMLHttpRequest;return l.open("DELETE",e.href),l.onload=()=>{l.status>=200&&l.status<300?t():n()},l.send(),{abort:()=>{l.abort()}}}}},labelFileProcessingError:()=>i?.data}),this.#i.on("updatefiles",(()=>{this.files=[],this.files=this.#i.getFiles()}))}}#p(e){return this.#e.querySelector(e)||void 0}reset(){this.#i.destroy(this.#i.element),this.#e.innerHTML="",this.init()}}}();
